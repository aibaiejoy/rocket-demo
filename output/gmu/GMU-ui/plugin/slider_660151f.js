!function(t){t.ui.create("slider",{_data:{container:"",setup:!1,content:"",index:0,imgInit:2,imgZoom:!1,boundSpring:!1,springBack:!0,springBackDis:15,autoPlay:!0,autoPlayTime:4e3,animationTime:400,showArr:!0,showDot:!0,onclick:"",onslide:"",onslideend:"",_direction:1},_create:function(){this._createUI()._loadImg().trigger("create")},_init:function(){var e=this,i=e.data("index"),a=e.data("instance"),s=t.bind(e._eventHandler,e);t(e.data("wheel")).on("touchstart touchmove touchend touchcancel webkitTransitionEnd",s),t(window).on("ortchange",s),t(".ui-slider-pre",a).on("tap",function(){e.pre()
}),t(".ui-slider-next",a).on("tap",function(){e.next()}),i&&e._slide(i,0),e.data("onclick")&&e.widget().on("click",e.data("onclick")),e.data("autoPlay")&&e._setTimeout(),e.on("destroy",function(){clearTimeout(e.data("play")),t(window).off("ortchange",s)}),e.trigger("init")},_createUI:function(){var e,i=this;if(i.data("setup"))e=i.widget().addClass("ui-slider")[0],i.data("boundSpring")||t(".ui-slider-wheel",e).append(t(".ui-slider-group",e).clone());else{e=(i.widget()||i.widget(t("<div></div>"))).addClass("ui-slider")[0],e.parentNode?i.data("container")&&t(i.data("container")).append(e):t(i.data("container")||document.body).append(e);
var a,s=0,n=[],r=i.data("content");1==r.length&&i.data("showArr",!1),e.innerHTML='<div class="ui-slider-wheel"><div class="ui-slider-group">'+function(){for(;a=r[s];s++)n.push('<div class="ui-slider-item"><a href="'+a.href+'"><img class="ui-slider-lazyload" lazyload="'+a.pic+'"/></a><p class="ui-slider-items-bottom">'+(a.smallpic?'<a href="'+a.href+'"><img class="ui-slider-smallpic" src="'+a.smallpic+'" /></a>':"")+(a.title?'<a href="'+a.href+'"><span class="ui-slider-title">'+a.title+"</span></a>":"")+(a.subTitle?'<br /><span class="ui-slider-subTitle">'+a.subTitle+"</span>":"")+"</p></div>");
if(n.push(i.data("boundSpring")?"</div></div>":'</div><div class="ui-slider-group">'+n.join("")+"</div></div>"),i.data("showDot")){for(n.push('<p class="ui-slider-items-dots">');s--;)n.push("<b></b>");n.push("</p>")}return i.data("showArr")&&n.push('<span class="ui-slider-pre"><b></b></span><span class="ui-slider-next"><b></b></span>'),n.join("")}()}var d=e.offsetWidth,o=e.offsetHeight,l=t(".ui-slider-item",e).css("width",d+"px").toArray(),c=l.length,u=t(".ui-slider-wheel",e).css("width",d*c+"px")[0],h=t(".ui-slider-items-dots b",e).toArray();
return i.data("showDot")&&(h[i.data("index")].className="ui-slider-dot-select"),i.data({instance:e,wheel:u,items:l,length:c,width:d,height:o,dots:h}),i},_loadImg:function(){var e=this,i=e.data("instance"),a=t(".ui-slider-lazyload",i),s=t(".ui-slider-lazyload",i).toArray();e.data("imgZoom")&&a.on("load",function(){var t=this.height,i=this.width,a=e.data("height"),s=e.data("width"),n=Math.min(t,a),r=Math.min(i,s);this.style.cssText+=t/a>i/s?"height:"+n+"px;width:"+n/t*i+"px;":"height:"+r/i*t+"px;width:"+r+"px",this.onload=null
});var n=a.toArray();(1==n.length||2==n.length&&!e.data("boundSpring"))&&e.data("autoPlay",!1);for(var r=0,d="",o=n.length,l=e.data("imgInit")||n.length;l>r;r++)d=s.shift(),d&&(d.src=d.getAttribute("lazyload")),e.data("boundSpring")||(d=n[r+o/2],d&&(d.src=d.getAttribute("lazyload")));var c=e.data("items"),u=e.data("length"),h=e.data("width");for(r=0;u>r;r++)c[r].style.cssText+="-webkit-transform:translate3d("+r*h+"px,0,0);z-index:"+(900-r);return e.data({lazyImgs:s,allImgs:n}),e},_setTimeout:function(){var t=this,e=t._data;
if(e.autoPlay)return clearTimeout(e.play),e.play=setTimeout(function(){t._slide.call(t,e.index+e._direction,!0)},e.autoPlayTime),t},_slide:function(t,e){var i=this,a=i._data,s=a.length;return t>-1&&s>t?i._move(t):t==s?a.boundSpring?(i._move(t-(e?2:1)),a._direction=-1):(a.wheel.style.cssText+="-webkit-transition:0ms;-webkit-transform:translate3d(-"+(s/2-1)*a.width+"px,0,0);",a._direction=1,setTimeout(function(){i._move(s/2)},20)):(a.boundSpring?i._move(t+(e?2:1)):(a.wheel.style.cssText+="-webkit-transition:0ms;-webkit-transform:translate3d(-"+s/2*a.width+"px,0,0);",setTimeout(function(){i._move(s/2-1)
},20)),a._direction=1),i},_move:function(t){var e=this._data,i=e.boundSpring?t:t>e.length/2-1?t-e.length/2:t;if(e.onslide&&this.trigger("slide",i),e.lazyImgs.length){var a=e.allImgs[t];a.src||(a.src=a.getAttribute("lazyload"))}e.showDot&&(e.instance.getElementsByClassName("ui-slider-dot-select")[0].className="",e.dots[i].className="ui-slider-dot-select"),e.index=t,e.wheel.style.cssText+="-webkit-transition:"+e.animationTime+"ms;-webkit-transform:translate3d(-"+t*e.width+"px,0,0);"},_eventHandler:function(t){var e=this;
switch(t.type){case"touchmove":e._touchMove(t);break;case"touchstart":e._touchStart(t);break;case"touchcancel":case"touchend":e._touchEnd();break;case"webkitTransitionEnd":e._transitionEnd();break;case"ortchange":e._resize.call(e)}},_touchStart:function(t){var e=this;e.data({pageX:t.touches[0].pageX,pageY:t.touches[0].pageY,S:!1,T:!1,X:0}),e.data("wheel").style.webkitTransitionDuration="0ms"},_touchMove:function(t){var e=this._data,i=e.X=t.touches[0].pageX-e.pageX;if(!e.T){var a=e.index,s=e.length,n=Math.abs(i)<Math.abs(t.touches[0].pageY-e.pageY);
e.boundSpring||(e.index=a>0&&s-1>a?a:a==s-1&&0>i?s/2-1:0==a&&i>0?s/2:a),!n&&clearTimeout(e.play),e.T=!0,e.S=n}e.S||(t.preventDefault(),e.wheel.style.webkitTransform="translate3d("+(i-e.index*e.width)+"px,0,0)")},_touchEnd:function(){var t=this._data,e=t.springBack?t.springBackDis:0;!t.S&&this._slide(t.index+(t.X<=-e?1:t.X>e?-1:0))},_transitionEnd:function(){var t=this,e=t._data;if(e.onslideend){var i=e.index,a=e.length;t.trigger("slideend",e.boundSpring?i:i>a/2-1?i-a/2:i)}if(e.lazyImgs.length){var s=e.lazyImgs.shift();
s.src=s.getAttribute("lazyload"),e.boundSpring||(s=e.allImgs[i+e.length/2],s&&!s.src&&(s.src=s.getAttribute("lazyload")))}return t._setTimeout(),t},_resize:function(){var t=this,e=t._data,i=e.width=e.instance.offsetWidth,a=e.length,s=e.items;clearTimeout(e.play);for(var n=0;a>n;n++)s[n].style.cssText+="width:"+i+"px;-webkit-transform:translate3d("+n*i+"px,0,0);";return e.wheel.style.cssText+="width:"+i*a+"px;-webkit-transition:0ms;-webkit-transform:translate3d(-"+e.index*i+"px,0,0);",e._direction=1,t._setTimeout(),t
},pre:function(){var t=this;return t._slide(t.data("index")-1),t},next:function(){var t=this;return t._slide(t.data("index")+1),t},stop:function(){var t=this;return clearTimeout(t.data("play")),t.data("autoPlay",!1),t},resume:function(){var t=this;return t.data("_direction",1),t.data("autoPlay",!0),t._setTimeout(),t}})}(Zepto);