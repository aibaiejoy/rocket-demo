!function(t){t.ui.create("slider",{_data:{container:"",setup:!1,content:"",index:0,imgInit:2,imgZoom:!1,boundSpring:!1,springBack:!0,springBackDis:15,autoPlay:!0,autoPlayTime:4e3,animationTime:400,showArr:!0,showDot:!0,onclick:"",onslide:"",onslideend:"",_direction:1},_create:function(){this._createUI()._loadImg()},_init:function(){var e=this,a=e.data("index"),i=e.data("instance"),n=t.bind(e._eventHandler,e);t(e.data("wheel")).on("touchstart touchmove touchend touchcancel webkitTransitionEnd",n),t(window).on("ortchange",n),t(".ui-slider-pre",i).on("tap",function(){e.pre()
}),t(".ui-slider-next",i).on("tap",function(){e.next()}),e.data("onclick")&&e.widget().on("click",e.data("onclick")),a&&e._slide(a,0),e.data("autoPlay")&&e._setTimeout(),e.on("destroy",function(){clearTimeout(e.data("play")),t(window).off("ortchange",n)})},_createUI:function(){var e,a=this;if(a.data("setup"))e=a.widget().addClass("ui-slider")[0],a.data("boundSpring")||t(".ui-slider-wheel",e).append(t(".ui-slider-group",e).clone());else{e=(a.widget()||a.widget(t("<div></div>"))).addClass("ui-slider")[0],e.parentNode?a.data("container")&&t(a.data("container")).append(e):t(a.data("container")||document.body).append(e);
var i,n=0,s=[],r=a.data("content");1==r.length&&a.data("showArr",!1),e.innerHTML='<div class="ui-slider-wheel"><div class="ui-slider-group">'+function(){for(;i=r[n];n++)s.push('<div class="ui-slider-item"><a href="'+i.href+'"><img class="ui-slider-lazyload" lazyload="'+i.pic+'"/></a><p class="ui-slider-items-bottom"><a href="'+i.href+'"><img class="ui-slider-smallpic" src="'+i.smallpic+'" /></a><a href="'+i.href+'"><span class="ui-slider-title">'+i.title+'</span></a><br /><span class="ui-slider-subTitle">'+i.subTitle+"</span></p></div>");
if(s.push(a.data("boundSpring")?"</div></div>":'</div><div class="ui-slider-group">'+s.join("")+"</div></div>"),a.data("showDot")){for(s.push('<p class="ui-slider-items-dots">');n--;)s.push("<b></b>");s.push("</p>")}return a.data("showArr")&&s.push('<span class="ui-slider-pre"><b></b></span><span class="ui-slider-next"><b></b></span>'),s.join("")}()}var d=e.offsetWidth,o=e.offsetHeight,l=t(".ui-slider-item",e).css("width",d+"px").toArray(),c=l.length,u=t(".ui-slider-wheel",e).css("width",d*c+"px")[0],h=t(".ui-slider-items-dots b",e).toArray();
return a.data("showDot")&&(h[a.data("index")].className="ui-slider-dot-select"),a.data({instance:e,wheel:u,items:l,length:c,width:d,height:o,dots:h}),a},_loadImg:function(){var e=this,a=e.data("instance"),i=t(".ui-slider-lazyload",a),n=t(".ui-slider-lazyload",a).toArray();e.data("imgZoom")&&i.on("load",function(){var t,a,i=this.height,n=this.width,s=e.data("height"),r=e.data("width"),d=this.style;i/s>n/r?(t=Math.min(i,s),d.height=t+"px",d.width=t/i*n+"px"):(a=Math.min(n,r),d.width=a+"px",d.height=a/n*i+"px"),this.onload=null
});var s=i.toArray();(1==s.length||2==s.length&&!e.data("boundSpring"))&&e.data("autoPlay",!1);for(var r=0,d="",o=s.length,l=e.data("imgInit")||s.length;l>r;r++)d=n.shift(),d&&(d.src=d.getAttribute("lazyload")),e.data("boundSpring")||(d=s[r+o/2],d&&(d.src=d.getAttribute("lazyload")));var c=e.data("items"),u=e.data("length"),h=e.data("width");for(r=0;u>r;r++)c[r].style.cssText+="-webkit-transform:translate3d("+r*h+"px,0,0);z-index:"+(900-r);return e.data({lazyImgs:n,allImgs:s}),e},_setTimeout:function(){var t=this,e=t._data;
if(e.autoPlay)return clearTimeout(e.play),e.play=setTimeout(function(){t._slide.call(t,e.index+e._direction,!0)},e.autoPlayTime),t},_slide:function(t,e){var a=this,i=a._data,n=i.length;return t>-1&&n>t?a._move(t):t==n?i.boundSpring?(a._move(t-(e?2:1)),i._direction=-1):(i.wheel.style.cssText+="-webkit-transition:0ms;-webkit-transform:translate3d(-"+(n/2-1)*i.width+"px,0,0);",i._direction=1,setTimeout(function(){a._move(n/2)},20)):(i.boundSpring?a._move(t+(e?2:1)):(i.wheel.style.cssText+="-webkit-transition:0ms;-webkit-transform:translate3d(-"+n/2*i.width+"px,0,0);",setTimeout(function(){a._move(n/2-1)
},20)),i._direction=1),a},_move:function(t){var e=this._data,a=e.boundSpring?t:t>e.length/2-1?t-e.length/2:t;if(e.onslide&&this.trigger("slide",a),e.lazyImgs.length){var i=e.allImgs[t];i.src||(i.src=i.getAttribute("lazyload"))}e.showDot&&(e.instance.getElementsByClassName("ui-slider-dot-select")[0].className="",e.dots[a].className="ui-slider-dot-select"),e.index=t,e.wheel.style.cssText+="-webkit-transition:"+e.animationTime+"ms;-webkit-transform:translate3d(-"+t*e.width+"px,0,0);"},_eventHandler:function(t){var e=this;
switch(t.type){case"touchmove":e._touchMove(t);break;case"touchstart":e._touchStart(t);break;case"touchcancel":case"touchend":e._touchEnd();break;case"webkitTransitionEnd":e._transitionEnd();break;case"ortchange":e._resize.call(e)}},_touchStart:function(t){var e=this;e.data({pageX:t.touches[0].pageX,pageY:t.touches[0].pageY,S:!1,T:!1,X:0}),e.data("wheel").style.webkitTransitionDuration="0ms"},_touchMove:function(t){var e=this._data,a=e.X=t.touches[0].pageX-e.pageX;if(!e.T){var i=e.index,n=e.length,s=Math.abs(a)<Math.abs(t.touches[0].pageY-e.pageY);
e.boundSpring||(e.index=i>0&&n-1>i?i:i==n-1&&0>a?n/2-1:0==i&&a>0?n/2:i),!s&&clearTimeout(e.play),e.T=!0,e.S=s}e.S||(t.preventDefault(),e.wheel.style.webkitTransform="translate3d("+(a-e.index*e.width)+"px,0,0)")},_touchEnd:function(){var t=this._data,e=t.springBack?t.springBackDis:0;!t.S&&this._slide(t.index+(t.X<=-e?1:t.X>e?-1:0))},_transitionEnd:function(){var t=this,e=t._data;if(e.onslideend){var a=e.index,i=e.length;t.trigger("slideend",e.boundSpring?a:a>i/2-1?a-i/2:a)}if(e.lazyImgs.length){var n=e.lazyImgs.shift();
n.src=n.getAttribute("lazyload"),e.boundSpring||(n=e.allImgs[a+e.length/2],n&&!n.src&&(n.src=n.getAttribute("lazyload")))}return t._setTimeout(),t},_resize:function(){var t=this,e=t._data,a=e.width=e.instance.offsetWidth,i=e.length,n=e.items;clearTimeout(e.play);for(var s=0;i>s;s++)n[s].style.cssText+="width:"+a+"px;-webkit-transform:translate3d("+s*a+"px,0,0);";return e.wheel.style.cssText+="width:"+a*i+"px;-webkit-transition:0ms;-webkit-transform:translate3d(-"+e.index*a+"px,0,0);",e._direction=1,t._setTimeout(),t
},pre:function(){var t=this;return t._slide(t.data("index")-1),t},next:function(){var t=this;return t._slide(t.data("index")+1),t},stop:function(){var t=this;return clearTimeout(t.data("play")),t.data("autoPlay",!1),t},resume:function(){var t=this;return t.data("_direction",1),t.data("autoPlay",!0),t._setTimeout(),t}})}(Zepto);