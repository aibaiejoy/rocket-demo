!function(){window.rocket=window.rocket||{}}(Zepto),function(e){var t,n,i=rocket.utils=rocket.utils||{};e.extend(i,{tip:function(i,a,o,r){var s=e(".global-tip"),c=e(window).height();switch(r=r||1500,0==s.length&&(s=e('<div class="global-tip"><span></span></div>'),e("body").prepend(s)),n&&t&&clearTimeout(t),n=!0,s.find("span").text(i),a){case 0:s.css("text-align","center");break;case 1:s.css("text-align","left");break;case 2:s.css("text-align","right")}switch(o){case 0:s.css("top",c/2+"px");break;
case 1:s.css("top","10px");break;case 2:s.css("bottom","10px")}s.css({"-webkit-transition":"none",opacity:1}),s.show(),t=setTimeout(function(){s.animate({opacity:0},300,"",function(){s.hide(),s.css({"-webkit-transition":"none",opacity:1}),n=!1})},r)}})}(Zepto),function(e){rocket.baseview=Backbone.View.extend({events:{},init:function(){},initialize:function(e,t){var n=this;n.options=e||{__empty:!0},n.parent=t||null,n.children={},n.length=0,n.ec=n.getRoot(),n.subec=n.getSubEC(),n.featureString=n.getFeatureString(),n.$globalLoading=rocket.$globalLoading,n.$pageLoading=rocket.$pageLoading,n.pageOrientation=n.pageOrientationToBe=window.orientation,n.init(n.options),n._registerEvents(),n.registerEvents()
},getRoot:function(){var e,t,n=this;for(e=t=n;e;)t=e,e=e.parent;return t},getSubEC:function(){var e,t,n=this;for(e=t=n;e;){if(e instanceof rocket.subpageview)return e;t=e,e=e.parent}return t},getFeatureString:function(t){var n=this,i=t||n.options,a="";return a=e.param(i,!0),t||(n.featureString=a),a},showLoading:function(t){var n=this;t&&e(t).append(n.$pageLoading),n.$pageLoading.show(),n.$globalLoading.hide()},hideLoading:function(e){var t=this;return 0>e?(t.$globalLoading.hide(),void t.$pageLoading.remove()):void setTimeout(function(){t.$pageLoading.remove()
},void 0===e?300:e)},append:function(e){this._addSubview(e)},appendTo:function(e,t){this._addSubview(e,"APPENDTO",t)},prepend:function(e){this._addSubview(e,"PREPEND")},setup:function(e){this._addSubview(e,"SETUP")},_addSubview:function(t,n,i){var a=this;if(!(t instanceof rocket.baseview))throw new Error("rocket.view.append arguments must be an instance of rocket.view");switch(a.children[t.cid]=t,a.length++,t.parent=a,n){case"SETUP":break;case"PREPEND":a.$el.prepend(t.$el);break;case"APPENDTO":e(i).append(t.$el);
break;default:a.$el.append(t.$el)}t.$el.hide()},remove:function(e){var t=this;e instanceof rocket.baseview?(delete t.children[e.cid],t.length--,e.parent=null,e.$el.remove()):t.parent&&t.parent.remove(t)},firstChild:function(){var e=this;for(var t in e.children)return e.children[t];return null},nextSibling:function(){var e=this,t=e.parent,n=null,i=null;if(!t)return null;for(var a in t.children)if(n=i,i=t.children[a],n==e)return i;return null},prevSibling:function(){var e=this,t=e.parent,n=null,i=null;
if(!t)return null;for(var a in t.children)if(n=i,i=t.children[a],i==e)return n;return null},destroy:function(){var e=this;for(var t in e.children)e.children[t].destroy();e._unregisterEvents(),e.unregisterEvents(),e.undelegateEvents(),this.$el.remove(),e.el=e.$el=null,e.parent&&delete e.parent.children[e.cid]},registerEvents:function(){},unregisterEvents:function(){},onorientationchange:function(){},_registerEvents:function(){var t=this,n=t.ec;t._onorientationchange=function(){t.pageOrientationToBe=window.orientation,n.isActivePage()&&t.pageOrientation!=t.pageOrientationToBe&&(t.onorientationchange(t.pageOrientation,t.pageOrientationToBe),t.pageOrientation=t.pageOrientationToBe)
},e(window).on("orientationchange",t._onorientationchange),n.on("pagebeforechange",t._onpagebeforechange,t),n.on("pageafterchange",t._onpageafterchange,t)},_unregisterEvents:function(){var t=this,n=t.ec;e(window).off("orientationchange",t._onorientationchange),t.onorientationchange=t.onsubpagebeforechange=t.onsubpageafterchange=function(){},n.off("pagebeforechange",t._onpagebeforechange,t),n.off("pageafterchange",t._onpageafterchange,t)},_onpagebeforechange:function(e){var t=this,n=e.from,i=e.to,a=e.params,o=t.getFeatureString(a),r=t.subpageManager;
t.pageOrientation!=t.pageOrientationToBe&&(t.onorientationchange(t.pageOrientation,t.pageOrientationToBe),t.pageOrientation=t.pageOrientationToBe),r&&r._subpages.length&&i==t.ec&&n!=i&&r._currentSubpage&&r._currentSubpage.featureString!=o&&r._currentSubpage.$el.hide()},_onpageafterchange:function(t){var n,i,a=this,o=t.from,r=t.to,s=t.params,c=a.getFeatureString(s),u=a.subpageManager;if(r==a.ec&&u&&u._subpages.length){if(!u.getSubpage(c)){var g=new u._subpageClass(e.extend({},s),a);a.append(g),u.registerSubpage(c,g)
}u.setCurrentSubpage(u.getSubpage(c)),n=u._previousSubpage,i=u._currentSubpage,o==r?u.switchSubpage(n,i,t):r==a.ec&&(e.each(n==i?[n]:[n,i],function(e,n){n&&n.onsubpagebeforechange&&n.onsubpagebeforechange(t),n&&n.onsubpageafterchange&&n.onsubpageafterchange(t)}),u.recycleSubpage())}},getSubpageManager:function(e){var t,n=this;return(t=n.subpageManager)?t:t=n.subpageManager=new rocket.subpagemanager(e,n)},refreshViewHeight:function(){var e,t=this,n=(new Date).getTime();return rocket.isLoaded?(t.refreshRequestStack=t.refreshRequestStack||[],t.lastRefreshTime=t.lastRefreshTime||n,e=t.refreshRequestStack,n-t.lastRefreshTime<1e3&&t.isNotFirstRefresh?void e.push(1):(e.length=0,setTimeout(function(){t.refreshHeight&&t.refreshHeight(),t.lastRefreshTime=(new Date).getTime(),setTimeout(function(){e.length>0&&(e.length=0,t.refreshHeight&&t.refreshHeight())
},1e3)},0),void(t.isNotFirstRefresh=!0))):void setTimeout(function(){t.refreshViewHeight()},200)},tip:function(){rocket.utils.tip.apply(window,arguments)},show:function(){var e=this;setTimeout(function(){e.$el.show(),e.onsubviewshow&&e.onsubviewshow()},0)},hide:function(){this.$el.hide()},navigate:function(e){Backbone.history.navigate(e,{trigger:!0})}})}(Zepto),function(){rocket.collection=Backbone.Collection.extend({initialize:function(){}})}(Zepto),function(){rocket.model=Backbone.Model.extend({initialize:function(){}})
}(Zepto),function(e){rocket.pageview=rocket.baseview.extend({initialize:function(e,t){var n=this;if(!t)throw Error("pageview creation: must supply non-empty action parameter");n.action=t,n._tops={},n._currentLogicString=n._getLogicString(e),rocket.baseview.prototype.initialize.call(n,e,null)},isActivePage:function(){var e=this;return"block"==e.$el.css("display")},_getLogicString:function(t){return e.param(t||{},!0)||"__empty_logic_string__"},savePos:function(){var e=this;e._tops[e._currentLogicString]=window.scrollY
},restorePos:function(e,t){var n=this,i=n._currentLogicString=n._getLogicString(e);setTimeout(function(){window.scrollTo(0,n._tops[i]||t||0)},0)}})}(Zepto),function(){rocket.subpageview=rocket.baseview.extend({initialize:function(e,t){if(!(t instanceof rocket.baseview))throw Error("rocket.subpageview creation: must supply parentView, which is an instance of rocket.baseview");rocket.baseview.prototype.initialize.call(this,e,t)},isActiveSubpage:function(){var e=this;return"block"==e.$el.css("display")
}})}(Zepto),function(e){rocket.router=Backbone.Router.extend({initialize:function(){this.views={},this.currentView=null,this.previousView=null},routes:{},pageOrder:[],defaultPageTransition:"simple",pageTransition:{},doAction:function(e,t){var n=this,i=n.views[e];i||(i=n.views[e]=new rocket.pageview[e](t,e)),n.previousView=n.currentView,n.currentView=i,n.trigger("routechange",{from:n.previousView,to:n.currentView}),n.switchPage(n.previousView,n.currentView,t)},switchPage:function(t,n,i){var a,o,r=this,s=0,c=r.pageOrder,u=t&&t.action||null,g=n&&n.action||null;
null!==u&&null!==g&&u!==g&&-1!=(a=c.indexOf(u))&&-1!=(o=c.indexOf(g))&&(s=a>o?2:1),r.enablePositionRestore&&t&&t.savePos(),e.each(t==n?[t]:[t,n],function(e,t){t&&t.trigger("pagebeforechange",{from:r.previousView,to:r.currentView,params:i})}),r.doAnimation(t,n,s,function(){r.enablePositionRestore&&n&&n.restorePos(i),e.each(t==n?[t]:[t,n],function(e,t){t&&t.trigger("pageafterchange",{from:r.previousView,to:r.currentView,params:i})})})},doAnimation:function(e,t,n,i){var a,o=this;(a=o._selectAnimation(e&&e.action||null,t&&t.action||null)||rocket["pageanimation_"+o.defaultPageTransition].animate)(e&&e.el,t&&t.el,n,i)
},_selectAnimation:function(e,t){if(null!=e&&null!=t){var n,i=this;return n=i.pageTransition[e+"-"+t]||i.pageTransition[t+"-"+e],rocket["pageanimation_"+n]&&rocket["pageanimation_"+n].animate}}})}(Zepto),function(){rocket.subview=rocket.baseview.extend({initialize:function(e,t){if(!(t instanceof rocket.baseview))throw Error("rocket.subview creation: must supply parentView, which is an instance of rocket.baseview");rocket.baseview.prototype.initialize.call(this,e,t)}})}(Zepto),function(e){rocket.globalview=rocket.baseview.extend({initialize:function(e,t){var n=this;
if(!t||!t instanceof rocket.router)throw Error("globalview creation: must supply an instance of rocket.router");n.router=t,n.router.on("routechange",n._onroutechange,n),rocket.baseview.prototype.initialize.call(n,e,null)},isActivePage:function(){return!1},_onroutechange:function(t){{var n=this;t.from,t.to,t.pageviews}n.trigger("routechange",e.extend({},t))},triggerPageEvent:function(t,n,i){var a,o=this,r=t.split(/\s*,\s*/);e.each(r,function(e,t){a=o.router.views[t],a&&a.trigger(n,i)})},getCurrentAction:function(){return this.router&&this.router.currentView.action||""
}})}(Zepto),function(e){rocket.subpagemanager=function(e,t){var n=this,i=e||{};n._subpageClass=i.subpageClass||null,n.MAX_SUBPAGES=i.maxSubpages||3,n.subpageTransition=i.subpageTransition||"slide",n.subpageManagerView=t,n._subpages=[],n._currentSubpage=null,n._previousSubpage=null,n.defaultSubpageTransition="slide"},rocket.subpagemanager.prototype={switchSubpage:function(t,n,i){var a=this,o=0;o=a.subpageManagerView.getSubpageSwitchDir?a.subpageManagerView.getSubpageSwitchDir(t,n):a.getSubpageSwitchDir(t,n),e.each(t==n?[t]:[t,n],function(e,t){t&&t.onsubpagebeforechange&&t.onsubpagebeforechange(i)
}),a.doSubpageAnimation(t,n,o,function(){e.each(t==n?[t]:[t,n],function(e,t){t&&t.onsubpageafterchange&&t.onsubpageafterchange(i)}),a.recycleSubpage()})},getSubpageSwitchDir:function(e,t){for(var n=this,i=0,a=n._subpages,o=e&&e.getFeatureString()||null,r=t&&t.getFeatureString()||null,s=-1,c=-1,u=0;u<a.length;u++)a[u].name==o&&(s=u),a[u].name==r&&(c=u);return null!==o&&null!==r&&o!==r&&-1!=s&&-1!=c&&(i=s>c?2:1),i},doSubpageAnimation:function(e,t,n,i){var a,o=this;(a=rocket["pageanimation_"+o.subpageTransition].animate)(e&&e.el,t&&t.el,n,i)
},registerSubpage:function(e,t){var n=this;n.getSubpage(e)||n._subpages.push({name:e,subpage:t})},getSubpage:function(e){for(var t=this,n=t._subpages,i=0,a=n.length;a>i;i++)if(n[i].name==e)return n[i].subpage},setCurrentSubpage:function(e){var t=this;if(!(e instanceof rocket.baseview))throw Error("error in method setCurrentSubpage: subpage is not an instance of rocket.baseview");e!=t._currentSubpage&&(t._previousSubpage=t._currentSubpage,t._currentSubpage=e)},recycleSubpage:function(){for(var e,t=this,n=t._subpages;n.length>t.MAX_SUBPAGES;)e=n.shift(),e.subpage==t._currentSubpage?t._subpages.push(e):e.subpage.destroy()
}}}(Zepto),function(e){function t(e,t,n){return"translate"+(rocket.has3d?"3d":"")+"("+e+"px, "+t+"px"+(rocket.has3d?", "+n+"px)":")")}rocket.pageanimation_dropdown={},rocket.pageanimation_dropdown.animate=function(n,i,a,o,r){if(0===a)return n!=i&&(n&&e(n).hide(),setTimeout(function(){i&&e(i).show()},0)),void(o&&o());r=!0,i=e(i),n=e(n);var s=document.documentElement.clientHeight,s=e(window).height();1==a?(n.css("z-index",1e3),i.css("z-index",999)):(n.css("z-index",999),i.css("z-index",1e3)),n.css({"-webkit-transition-property":"-webkit-transform","-webkit-transform":t(0,0,0),"-webkit-transition-duration":"0ms","-webkit-transition-timing-function":"ease-out","-webkit-transition-delay":"initial"}),i.css({"-webkit-transition-property":"-webkit-transform","-webkit-transform":t(0,1===a?"0":"-"+s,0),"-webkit-transition-duration":"0ms","-webkit-transition-timing-function":"ease-out","-webkit-transition-delay":"initial",display:"block"}),setTimeout(function(){function e(){r?(n.css({display:"none","-webkit-transform":t(0,0,0),"-webkit-transition-duration":"0ms"}),i.css({display:"block","-webkit-transform":t(0,0,0),"-webkit-transition-duration":"0ms"})):(n.css({display:"none"}),i.css({display:"block"}))
}1==a?n.css({"-webkit-transform":t(0,-s,0),"-webkit-transition-duration":"450ms"}):i.css({"-webkit-transform":t(0,0,0),"-webkit-transition-duration":"450ms"}),setTimeout(function(){setTimeout(function(){e(),o&&o()},0)},500)},0)}}(Zepto),function(e){rocket.pageanimation_fade={},rocket.pageanimation_fade.animate=function(t,n,i,a){var o=t&&e(t),r=n&&e(n);n&&(t&&t!=n?(o.hide(),r.show(),r.css({opacity:.05}),r.animate({opacity:1},600,"ease-in",a)):(r.show(),a&&a()))}}(Zepto),function(e){rocket.pageanimation_simple={},rocket.pageanimation_simple.animate=function(t,n,i,a){var o=t&&e(t),r=n&&e(n);
t!=n&&(t&&o.hide(),setTimeout(function(){n&&r.show()},0)),a&&a()}}(Zepto),function(e){function t(e,t,n){return"translate"+(rocket.has3d?"3d":"")+"("+e+"px, "+t+"px"+(rocket.has3d?", "+n+"px)":")")}rocket.pageanimation_slide={},rocket.pageanimation_slide.animate=function(n,i,a,o,r){if(0===a)return n!=i&&(n&&e(n).hide(),setTimeout(function(){i&&e(i).show()},0)),void(o&&o());r=!0,i=e(i),n=e(n);var s=document.documentElement.clientWidth;n.css({"-webkit-transition-property":"-webkit-transform","-webkit-transform":t(0,0,0),"-webkit-transition-duration":"0ms","-webkit-transition-timing-function":"ease-out","-webkit-transition-delay":"initial"}),i.css({"-webkit-transition-property":"-webkit-transform","-webkit-transform":t((1===a?"":"-")+s,0,0),"-webkit-transition-duration":"0ms","-webkit-transition-timing-function":"ease-out","-webkit-transition-delay":"initial",display:"block"}),setTimeout(function(){function e(){r?(n.css({display:"none","-webkit-transform":t(0,0,0),"-webkit-transition-duration":"0ms"}),i.css({display:"block","-webkit-transform":t(0,0,0),"-webkit-transition-duration":"0ms"})):(n.css({display:"none"}),i.css({display:"block"}))
}i.css({"-webkit-transform":t(0,0,0),"-webkit-transition-duration":"350ms"}),n.css({"-webkit-transform":t((1===a?"-":"")+s,0,0),"-webkit-transition-duration":"350ms"}),setTimeout(function(){setTimeout(function(){e(),o&&o()},0)},400)},0)}}(Zepto);